---
slug: /basic-troubleshooting
description: 本指南将帮助您在向PaperMC或插件作者报告问题之前诊断服务器的问题。
---

# 基本故障排除

本指南将帮助您在向 PaperMC 或插件作者报告问题之前诊断服务器的问题。

:::caution[停止服务器并进行备份]

在遵循本指南之前，请先停止服务器。修改正在运行的服务器文件会导致文件损坏。
只有完全关闭服务器才能防止这种情况发生。

此外，如果您不仔细遵循本指南或在遵循本指南时出错，可能会损坏服务器。强烈建议在遵循本指南之前备份服务器。
理想情况下，可以通过复制生产服务器的文件来创建测试服务器，但这并不总是可行的。

:::

## 阅读错误信息

如果服务器遇到问题，它会在服务器控制台上打印错误信息，创建崩溃报告并关闭自身，或者两者兼而有之。

如果服务器崩溃，崩溃报告将保存在`crash-report`目录中。
如果服务器没有崩溃，这些错误信息将与其他消息一起存储在`log`目录中。

请注意，最新的日志文件以外的日志将被压缩，而不是以纯文本文件存储。

您需要做的第一件事是诊断这些消息。

### 情况 01：Paper 看门狗线程转储

如果您的错误信息如下所示，**不要盲目地将其报告给 PaperMC**，因为它说：

```
[00:00:00] [Paper Watchdog Thread/ERROR]: --- DO NOT REPORT THIS TO PAPER - THIS IS NOT A BUG OR A CRASH - git-Paper-366 (MC: 1.19.3) ---
[00:00:00] [Paper Watchdog Thread/ERROR]: The server has not responded for 10 seconds! Creating thread dump
[00:00:00] [Paper Watchdog Thread/ERROR]: ------------------------------
```

这可能是由多种原因引起的。也许您的服务器硬件无法运行 Minecraft 服务器。也许您使用的某个插件导致了服务器延迟。

Paper 看门狗线程转储可以在该行下方找到。如果您在其中找到任何插件的名称，请与插件作者联系，而不是 PaperMC。

### 情况 02：堆栈跟踪

几乎每个您遇到的问题都会在服务器控制台上打印错误信息行，这些行称为“堆栈跟踪”。检查堆栈跟踪将帮助您找出导致服务器问题的原因。

堆栈跟踪以错误信息、异常类型和异常信息开始。

错误信息和异常信息是由您的插件或 Paper 的开发人员放置的。这些信息告诉您服务器遇到了什么问题。
像`java.lang.RuntimeException`这样的异常类型告诉您异常的类型。这将帮助开发人员（以及您）了解问题的类型。

异常信息下方可能会出现许多以`at`开头的行。这些是堆栈跟踪的主体。这些行告诉您问题从哪里开始。堆栈跟踪主体的顶行将准确告诉您问题发生的位置，并在可能的情况下显示其来源。

如果在堆栈跟踪中找到任何插件的名称，请前往[检查插件更新](#check-plugin-updates)并从那里开始阅读。在大多数情况下，堆栈跟踪中找到名称的插件是导致问题的原因。如果没有，请继续阅读。

以下是一些堆栈跟踪的示例。

<details>
  <summary>示例01：服务器尝试加载使用较新版本的Minecraft保存的区块！</summary>

```
[00:00:00 WARN]: java.lang.RuntimeException: Server attempted to load chunk saved with newer version of minecraft! 3218 > 3120
```

您尝试加载使用较高版本的 Minecraft 生成的世界。您不能这样做。
如果在区块版本更新之前没有备份您的世界，您必须使用较高版本的 Minecraft 来使用更新的世界。

</details>

## 找出罪魁祸首

如果您在线程转储或堆栈跟踪中找不到任何插件的名称，请尝试以下步骤。

### 禁用所有插件

要确定是插件还是 Paper 本身导致了问题，请先禁用所有插件。

您可以通过将`plugins`目录重命名为其他名称，例如`plugins-disabled`，或通过归档`plugins`目录并删除它来禁用所有插件。

之后，尝试运行服务器。

如果删除插件后问题解决了，您就知道是某个插件导致了问题。

### 二分搜索

要有效地查找导致问题的插件，您可以执行以下操作：

1. **将插件分成两组**
   两组的大小可以不同，但理想情况下差异最小。确保相互依赖的插件分组在一起。
2. **禁用其中一组插件**
   您可以通过将它们的扩展名从`.jar`更改为其他，例如`.jar-disabled`，或将它们移出`plugins`目录并放入临时目录来禁用它们。
3. **运行服务器并检查问题是否仍然存在**
   如果问题解决了，导致问题的插件是禁用的插件之一。
   如果问题没有解决，导致问题的插件是活动插件之一。
4. **从怀疑的插件组开始重复**
   对包含导致问题的插件的组重复上述步骤。

:::danger

您安装的一些插件不是典型的插件，而是库。这些插件像插件一样安装，
但往往提供很少的用户功能，并依赖于其他插件来实现其功能。如果禁用库，依赖它的插件将无法正常工作。常见的这些库的示例有 ProtocolLib、Vault 提供者、权限插件等。

:::

## 检查插件更新

您的问题可能已经在插件的最新版本或最新构建中修复。

前往插件的官方下载页面，检查您是否使用的是插件的最新构建或最新版本。如果不是，请更新到最新版本，然后再次运行服务器以查看问题是否解决。

### 更新库插件

许多插件使用库插件，如 ProtocolLib，您必须下载它们并放入`plugins`目录。

如果不将它们更新到最新版本或最新构建，可能会遇到与使用库插件的插件相关的问题。

一些库插件告诉用户使用其最新的开发构建以支持最新的 Minecraft 版本。您应该仔细查看插件的要求。

## 检查文档

如果您错误配置了插件或服务器，也会导致服务器出现问题。

### 插件文档

许多插件提供了有关如何正确设置它们的文档。仔细阅读这些文档，检查插件配置是否有问题。

### Paper 文档

Paper 也可以以多种方式配置。查看这些文档以获取每个配置的详细说明。

- [Paper 全局配置](../reference/configuration/global-configuration.mdx)
- [Paper 每个世界配置](../reference/configuration/world-configuration.mdx)

## 咨询开发人员

如果您的问题与您使用的插件有关，并且您仍然不知道如何解决，可以尝试联系插件的作者。
许多插件有联系作者的方式，如 GitHub 问题跟踪器、Discord 支持群、Gitter、IRC 等。

如果您的问题与任何插件无关，可以前往 PaperMC 的 Discord 服务器寻求帮助，或在我们的 GitHub 问题跟踪器上创建新问题。
