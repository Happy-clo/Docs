---
title: "基础问题排除"
---

本指南将帮助你在向 PaperMC 或插件作者报告问题前，分析你的服务器问题。

### 停止运行服务器并进行备份

在阅读此指南前，请先停止运行你的服务器。当服务器正在运行时修改服务器文件将会出现错误。
仅当服务器完全关闭后才会避免出现错误。  
以及，如果你不仔细地遵循本指南或当遵循此指南时不小心弄错，那么你也有可能导致服务器出现错误。因此，强烈建议当遵循此指南时将你的服务器进行备份。  
最理想的情况下是复制你的生产服务器文件以创建一个测试服务器，但这并不总是可行的。

## 阅读出错信息

如果你的服务器遇到了一个问题，那么它要不就在服务器控制台打印一份出错信息（error message），要么就创建一份 crash report 并自动关闭服务器，或两者都会发生。

若你的服务器崩溃（crashes），那么 crash report 将会保存在 `crash-report` 文件夹内。
若你的服务器没有崩溃，那么出错信息将与其他信息被存储在 `log` 文件夹内。

注意，如果日志要比最新（latest）生成的更晚，那么将会被压缩且不会以纯文本文件存储。

你需要做的第一件事就是诊断这些消息。

### 情况 01：Paper Watchdog Thread Dump

如果你的错误信息看起来像这样，**不要盲目地报告给 PaperMC**，就像字面上所说的一样：

```plaintext
[00:00:00] [Paper Watchdog Thread/ERROR]: --- DO NOT REPORT THIS TO PAPER - THIS IS NOT A BUG OR A CRASH - git-Paper-366 (MC: 1.19.3) ---
[00:00:00] [Paper Watchdog Thread/ERROR]: The server has not responded for 10 seconds! Creating thread dump
[00:00:00] [Paper Watchdog Thread/ERROR]: ------------------------------
```

它可以由很多原因引起。也许你的服务器硬件并不足以支撑运行 Minecraft 服务器。也许你使用的众多插件中有一个正在给你的服务器造成滞后。

由 Paper Watchdog 生成的 thread dump 可以在横线下面找到。如果你在里面发现了任何插件的名称，请与插件开发者联系，而不是找 PaperMC。

### 情况 02：堆栈跟踪

你遇到的大多数问题都将在服务器控制台上打印一些出错信息行，而这些则被称之为“堆栈跟踪（stack trace）”。通过分析堆栈跟踪将帮助你找出你的服务器上到底是什么导致出现了问题。

堆栈跟踪将以出错信息，异常类型（exception type）和异常信息（exception message）开始。

出错信息和异常信息都是由你每个插件的开发者或 paper 服务器放置的。这些信息将告诉你你的服务器之前遇到了什么问题。  
一个类似 `java.lang.RuntimeException` 的异常类型将告诉你异常的类型。这会帮助开发者（和你）了解问题的类型。

一些以 `at` 开头的将出现在异常信息的下面。这些是堆栈跟踪的主体部分。这些行将告诉你问题出现在哪里。堆栈跟踪主体的第一行将告诉你问题具体发生在哪里，以及如果可以的话，请从源头处禁用它。

如果在堆栈跟踪中找到任何插件的名字，请转到 [检查插件更新](#检查插件更新) 并从那里开始阅读。大多数情况下，如果可以在堆栈跟踪中找到插件的名字，那么很有可能是它所引起的问题。如果不是，请继续阅读。

这里有一些关于堆栈跟踪部分的例子。

### 例子 01：Server attempted to load chunk saved with newer version of minecraft!

```plaintext
[00:00:00 WARN]: java.lang.RuntimeException: Server attempted to load chunk saved with newer version of minecraft! 3218 > 3120
```

你试图加载一个由更高版本的 Minecraft 所生成的地图。你不能这么做。
如果你在升级区块版本前不进行任何备份操作，那么你必须使用更高版本的 Minecraft 来加载世界。

<!-- Another examples -->

## 找出哪个插件引起问题

如果你无法在 thread dump 或堆栈跟踪中找到任何插件的名称，请尝试以下步骤。

### 禁用全部插件

若想知道是插件还是 paper 本身引起的问题，请先禁用全部插件。  
你可以通过重命名 `plugins` 文件夹到其它名称以禁用全部插件，例如重命名为 `plugins-disabled`，或**备份** `plugins` 文件夹后删除它。  
之后，尝试运行你的服务器。  
如果在移除插件之后，问题解决，那么你就可以知道是某一个插件出现了问题。  
如果你依然遇到问题，请转到 [Paper 文档](#paper-文档)。也许你的 paper 服务器的某些配置出错，因此出现了问题。

### 二分法查找

若想高效地查找哪个插件引起的问题，你可以进行以下步骤：

1. **将你的插件分为两组**  
   这两组的大小可以不同，但是最理想的情况是两组差异最小。
2. **先禁用一组插件**  
   你可以通过将拓展名从 `.jar` 更改至 `.jar-disabled` 以禁用插件。
3. **运行服务器并检查问题是否已解决**  
   若问题已解决，那么引起问题的插件是已禁用插件组中的一个。  
   若问题仍未解决，那么引起问题的插件是未禁用插件组中的一个。
4. **对于有嫌疑的插件组，从头开始重复以上操作**  
   对于有嫌疑的插件组，请从头开始重复以上操作，直至问题解决。

### 译者注

部分插件运行需要依赖前置。建议将前置插件和该插件放在一组内以确保不会引起新的问题。

## 检查插件更新

有可能问题已经在插件最新的发布版本（release）或最新的构建（build）中被修复。

请前往你的插件官方网站并检查你是否使用最新的构建或最新的发布版本。如果不是最新版本，请更新至最新版本并尝试运行你的服务器以查看问题是否解决。

### 译者注

如果你正在运行插件最新版本不支持的服务器版本（例如 MythicMob 最新版不支持 1.12.2），请不要盲目更新。  
请确保下载的是所支持服务器版本的最新版本。

### 同时更新库（Library）插件

部分插件依赖于库插件（例如许多插件依赖 ProtocolLib）才能正常运行，因此你需要下载它们并放置于 `plugins` 文件夹内。

如果你不更新它们至最新版本或最新构建，那么可能会遇到一些依赖于该库插件的插件相关的一些问题。
一些库插件会告诉它们的用户使用最新开发构建以支持最新的 Minecraft 版本。你应该仔细查看插件的需求。

## 检查文档

如果你错误的配置了你的插件或你的服务器，它有可能也会在你的服务器上引起问题。

### 插件文档

一些插件提供了它们自己的文档，这些文档通常包含关于如何正确配置它们的内容。请仔细阅读这些文档并检查插件配置是否有问题。

### Paper 文档

Paper 也提供各种配置。检查这些文档以获得关于每个配置的详细解释。

- [Paper 全局配置](../reference/global-configuration.md)
- [Paper 针对世界的配置](../reference/world-configuration.md)

## 与开发者沟通

如果你的问题与你使用的插件有关且你依然不知道如何解决它，你可以尝试联系插件的开发者。  
许多插件都有联系到它们的开发者的办法，例如 GitHub issue tracker，Discord support guild，Gitter，IRC，等等。

如果你的问题与任何插件都无关，你可以前往 PaperMC 的 Discord 服务器并寻求帮助，或者在 PaperMC 的 GitHub issue tracker 创建一个新 issue。
